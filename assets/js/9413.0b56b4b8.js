"use strict";(self.webpackChunkdyte_docs=self.webpackChunkdyte_docs||[]).push([[9413],{7037:(e,t,i)=>{i.d(t,{T:()=>n,d:()=>s,e:()=>d,g:()=>o,h:()=>r,i:()=>c,p:()=>a,r:()=>l});i(5114);const a=e=>{let t=null;try{const i=JSON.parse(e.message),{target:a,message:s}=i;t=void 0===a||void 0===s?e:Object.assign(Object.assign({},e),{targetUserIds:a,message:s})}catch(i){t=e}return t};function s(e,t){return e.localeCompare(t)}function o(e){return e.sort(((e,t)=>e.localeCompare(t))).join("_")}function r(e,t){if(null!=e)for(const i of e)if("file"===i.kind){const e=i.getAsFile();i.type.startsWith("image/")?t("image",e):t("file",e)}}const n="dm__";function c(e){return e.isDirectMessage}function d(e){return[...new Set(e)].sort(s).join("<>")}function l(e){return e.split("").reverse().join("")}},2729:(e,t,i)=>{i.d(t,{d:()=>a,e:()=>s,f:()=>o});const a=(e,t)=>{const i=t.getTime()-e.getTime();return Math.round(Math.abs(i/1e3/60))},s=(e,t)=>{const i=a(e,t);if(i<2)return"just now";if(i<60)return`${i}m ago`;const s=Math.round(i/60);if(i<90)return`about ${s}h ago`;if(s<24)return`${s}h ago`;const o=Math.round(s/24);if(o<7)return`${o}d ago`;return`${Math.round(o/7)}w ago`},o=e=>e.toDateString()+" "+e.toLocaleTimeString()},9413:(e,t,i)=>{i.r(t),i.d(t,{dyte_channel_header:()=>b,dyte_channel_selector_ui:()=>f,dyte_chat_composer_ui:()=>x,dyte_chat_messages_ui:()=>k,dyte_chat_messages_ui_paginated:()=>P,dyte_chat_search_results:()=>C,dyte_chat_selector_ui:()=>_,dyte_dialog_manager:()=>R,dyte_notifications:()=>M});var a=i(5733),s=(i(1237),i(4555)),o=i(6633),r=i(336),n=i(804),c=i(7037),d=i(5114),l=i(2729),h=i(2321),p=i(1285),g=i(5371),u=i(6503),y=i(3367),m=i(1007),v=i(2906);i(6386);const b=class{constructor(e){(0,a.r)(this,e),this.search=(0,a.c)(this,"search",7),this.searchDismissed=(0,a.c)(this,"searchDismissed",7),this.onSearchClickHanlder=()=>{this.showSearchBar=!this.showSearchBar,this.showSearchBar?(0,a.w)((()=>{this.$searchInput.focus()})):this.searchDismissed.emit()},this.onKeyDownHandler=e=>{"Enter"===e.key?(this.search.emit(this.$searchInput.value),this.$searchInput.blur()):"Escape"===e.key&&(this.$searchInput.value="",this.showSearchBar=!1)},this.meeting=void 0,this.channel=void 0,this.iconPack=o.d,this.t=(0,r.u)(),this.showChannelDetailsDialog=!1,this.showSearchBar=!1,this.members=[]}onChannelChanged(){this.$searchInput&&(this.$searchInput.value=""),this.showSearchBar=!1,this.channel.isDirectMessage||this.meeting.chat.getChannelMembers(this.channel.id).then((e=>{this.members=e}))}connectedCallback(){this.onChannelChanged()}renderChannelDetails(){return(0,a.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.showChannelDetailsDialog=!1},iconPack:this.iconPack,t:this.t},(0,a.h)("dyte-channel-details",{members:this.members,channel:this.channel}))}render(){return this.channel?(0,a.h)(a.H,null,this.showChannelDetailsDialog&&this.renderChannelDetails(),(0,a.h)("header",{class:{searching:this.showSearchBar}},(0,a.h)("div",{class:"channel-details"},(0,a.h)("span",{class:"name"},this.channel.displayName),!this.channel.isDirectMessage&&(0,a.h)("span",{class:"members"},this.members.map((e=>e.name)).join(", "))),(0,a.h)("div",{class:"channel-tools"},this.showSearchBar&&(0,a.h)("input",{class:"search-input",type:"text",placeholder:this.t("chat.search_msgs"),ref:e=>this.$searchInput=e,onKeyDown:e=>this.onKeyDownHandler(e)}),(0,a.h)("dyte-tooltip",{label:this.showSearchBar?this.t("close"):this.t("chat.search_msgs"),iconPack:this.iconPack,t:this.t,variant:"primary"},(0,a.h)("dyte-button",{iconPack:this.iconPack,t:this.t,kind:"button",variant:"secondary",size:"md",onClick:this.onSearchClickHanlder,class:"br-primary-btn"},(0,a.h)("dyte-icon",{icon:this.showSearchBar?this.iconPack.dismiss:this.iconPack.search,iconPack:this.iconPack,t:this.t}))),!this.channel.isDirectMessage&&(0,a.h)("dyte-tooltip",{label:this.t("chat.channel_members"),iconPack:this.iconPack,t:this.t,variant:"primary"},(0,a.h)("dyte-button",{iconPack:this.iconPack,t:this.t,kind:"button",variant:"secondary",size:"md",onClick:()=>{this.showChannelDetailsDialog=!this.showChannelDetailsDialog},class:"br-primary-btn"},(0,a.h)("dyte-icon",{icon:this.iconPack.people,iconPack:this.iconPack,t:this.t})))))):null}static get watchers(){return{channel:["onChannelChanged"]}}};b.style="header{height:var(--dyte-space-8, 32px);padding:var(--dyte-space-4, 16px);padding-left:var(--dyte-space-12, 48px);display:flex;justify-content:space-between;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));border-left-width:var(--dyte-border-width-none, 0);border-right-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-sm, 1px);border-top-width:var(--dyte-border-width-none, 0);border-style:solid;--tw-border-opacity:1;border-bottom-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-border-opacity))}header.searching{justify-content:flex-end}header.searching .channel-details{display:none}header .channel-details{display:flex;flex-direction:column;justify-content:center;height:var(--dyte-space-9, 36px)}header .channel-details .name{font-weight:500}header .channel-details .members{margin-top:var(--dyte-space-0\\.5, 2px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:12px;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}header .channel-tools{display:flex}header .search-input{width:var(--dyte-space-52, 208px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);border-width:var(--dyte-border-width-none, 0);border-style:none;outline:2px solid transparent;outline-offset:2px;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}header .name{font-size:16px}header .br-primary-btn{background-color:transparent}header .br-primary-btn:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}@media (orientation: landscape) and (min-width: 400px){header{padding-left:var(--dyte-space-4, 16px)}header.searching{display:flex;justify-content:space-between}header.searching .channel-details{display:flex;flex-direction:column}}";const f=class{constructor(e){(0,a.r)(this,e),this.channelChanged=(0,a.c)(this,"channelChanged",7),this.handleResize=e=>{this.isHidden=!e.matches},this.channelSelected=e=>{this.channelChanged.emit(e),this.onRevealClicked()},this.onSearchInput=e=>{this.searchQuery=e.target.value},this.onRevealClicked=()=>{this.matchMedia.matches||(this.isHidden=!this.isHidden)},this.renderChannelDisplayPic=e=>{const t=e.displayPictureUrl&&0!==e.displayPictureUrl.length;return e.isDirectMessage||t?(0,a.h)("div",{class:"channel-display"},(0,a.h)("dyte-avatar",{participant:{name:e.displayName,picture:e.displayPictureUrl}})):(0,a.h)("div",{class:"channel-display"},(0,a.h)("dyte-icon",{icon:this.iconPack.people,slot:"start"}))},this.renderRecentMessage=e=>{if(!e.latestMessage)return(0,a.h)("p",{class:"latest-msg new"},this.t("chat.start_conversation"));let t=e.isDirectMessage?"":`${e.latestMessage.displayName}: `,i="";return"text"===e.latestMessage.type?i=e.latestMessage.message:"image"===e.latestMessage.type?i=this.t("image"):"file"===e.latestMessage.type&&(i=this.t("file")),(0,a.h)("p",{class:"latest-msg"},`${t}${i}`)},this.channels=void 0,this.selectedChannelId=void 0,this.iconPack=o.d,this.t=(0,r.u)(),this.showRecentMessage=!1,this.isHidden=!1,this.searchQuery=""}connectedCallback(){this.matchMedia=window.matchMedia("(orientation: landscape) and (min-width: 400px)"),this.matchMedia.addEventListener("change",this.handleResize),this.isHidden=!this.matchMedia.matches}disconnectedCallback(){this.matchMedia.removeEventListener("change",this.handleResize)}componentDidRender(){this.$el.style.transform=this.isHidden?"translateX(-380px)":"translateX(0)"}getTimeLabel(e){const t=e.time,i=new Date,a=new Date(i);a.setDate(i.getDate()-1);const s=new Date(i);if(s.setDate(i.getDate()-i.getDay()-1),t.toDateString()===i.toDateString())return t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(t.toDateString()===a.toDateString())return this.t("date.yesteday");if(t>s){const e=["date.sunday","date.monday","date.tuesday","date.wednesday","date.thursday","date.friday","date.saturday"];return this.t(e[t.getDay()])}return Intl.DateTimeFormat([],{day:"2-digit",month:"2-digit",year:"2-digit"}).format(t)}render(){return(0,a.h)(a.H,null,(0,a.h)("div",{class:"container",ref:e=>this.$el=e},this.isHidden&&(0,a.h)("dyte-button",{iconPack:this.iconPack,t:this.t,kind:"icon",variant:"ghost",size:"md",onClick:this.onRevealClicked,class:"sidebar-btn"},(0,a.h)("dyte-icon",{icon:this.isHidden?this.iconPack.chevron_left:this.iconPack.dismiss,iconPack:this.iconPack,t:this.t})),(0,a.h)("slot",{name:"header"}),(0,a.h)("div",{class:"search-wrapper"},(0,a.h)("div",{class:"search"},(0,a.h)("input",{type:"search",autocomplete:"off",placeholder:this.t("chat.search_conversations"),onInput:this.onSearchInput}),(0,a.h)("dyte-icon",{icon:this.iconPack.search,iconPack:this.iconPack,t:this.t,class:"search-icon"}))),(0,a.h)("div",{class:"channel-container",role:"list"},this.channels.filter((e=>""===this.searchQuery||e.displayName.includes(this.searchQuery))).map((e=>(0,a.h)("div",{class:{channel:!0,selected:e.id===this.selectedChannelId,highlight:!!e.unreadCount},role:"listitem",onClick:()=>{this.channelSelected(e.id)}},this.renderChannelDisplayPic(e),(0,a.h)("div",{class:"channel-card","is-direct-message":e.isDirectMessage},(0,a.h)("div",{class:"recent-message-row"},(0,a.h)("span",null,e.displayName),e.latestMessage&&(0,a.h)("span",{class:"latest-msg-time"},this.getTimeLabel(e.latestMessage))),(0,a.h)("div",{class:"recent-message-row"},this.renderRecentMessage(e),e.unreadCount>0&&e.id!==this.selectedChannelId?(0,a.h)("span",{class:"new-msgs-count"},e.unreadCount<99?e.unreadCount:"99+"):null))))))),!this.isHidden&&(0,a.h)("div",{class:"overlay-container"},(0,a.h)("dyte-button",{iconPack:this.iconPack,t:this.t,kind:"icon",variant:"ghost",size:"md",onClick:this.onRevealClicked,class:"sidebar-btn"},(0,a.h)("dyte-icon",{icon:this.isHidden?this.iconPack.chevron_left:this.iconPack.dismiss,iconPack:this.iconPack,t:this.t}))))}};f.style=":host{display:flex}.container{display:flex;height:100%;width:var(--dyte-space-96, 384px);flex-direction:column;position:absolute;--tw-translate-x:calc(var(--dyte-space-96, 384px) * -1);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));border-top-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-none, 0);border-right-width:var(--dyte-border-width-sm, 1px);border-left-width:var(--dyte-border-width-none, 0);border-style:solid;--tw-border-opacity:1;border-right-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-border-opacity));transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}@-webkit-keyframes fade{0%{opacity:0}100%{opacity:1}}@keyframes fade{0%{opacity:0}100%{opacity:1}}.overlay-container{width:100vw;--tw-translate-x:var(--dyte-space-96, 384px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms;-webkit-animation:fade 0.8s;animation:fade 0.8s}.overlay-container .sidebar-btn{position:static;padding:var(--dyte-space-4, 16px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.sidebar-btn{position:absolute;right:calc(var(--dyte-space-9, 36px) * -1);top:var(--dyte-space-4, 16px);height:var(--dyte-space-8, 32px);width:var(--dyte-space-7, 28px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));border-radius:var(--dyte-border-radius-sm, 4px)}@media (orientation: landscape) and (min-width: 400px){.container{position:static;--tw-translate-x:var(--dyte-space-0, 0px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.sidebar-btn,.overlay-container{display:none}}.search-wrapper{display:flex;align-items:center;gap:var(--dyte-space-2, 8px);padding:var(--dyte-space-2, 8px);border-top-width:var(--dyte-border-width-sm, 1px);border-bottom-width:var(--dyte-border-width-sm, 1px);border-left-width:var(--dyte-border-width-none, 0);border-right-width:var(--dyte-border-width-none, 0);border-style:solid;--tw-border-opacity:1;border-top-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-border-opacity));border-bottom-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-border-opacity))}.search{position:-webkit-sticky;position:sticky;box-sizing:border-box;display:flex;align-items:center;border-radius:var(--dyte-border-radius-sm, 4px);margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-0, 0px);height:var(--dyte-space-8, 32px);width:100%}.search .search-icon{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);padding:var(--dyte-space-2, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52));border-top-right-radius:var(--dyte-border-radius-sm, 4px);border-bottom-right-radius:var(--dyte-border-radius-sm, 4px)}.search input{box-sizing:border-box;width:100%;padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px);padding-left:var(--dyte-space-2, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));border-width:var(--dyte-border-width-none, 0);border-style:none;outline:2px solid transparent;outline-offset:2px;font-size:14px;line-height:1.25rem}.search input::-moz-placeholder{color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.search input::placeholder{color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.search input{border-top-left-radius:var(--dyte-border-radius-sm, 4px);border-bottom-left-radius:var(--dyte-border-radius-sm, 4px)}.channel-container{box-sizing:border-box;display:flex;flex-direction:column;padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px);overflow-y:scroll}.channel-container .channel{display:flex;align-items:center;justify-content:space-between;gap:var(--dyte-space-2, 8px);padding:var(--dyte-space-0, 0px);border-left-width:var(--dyte-border-width-none, 0);border-right-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-sm, 1px);border-top-width:var(--dyte-border-width-none, 0);border-style:solid;--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-border-opacity))}.channel-container .channel:hover{cursor:pointer;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-900, var(--dyte-colors-text-900, 255 255 255 / 0.88)))}.channel-container .channel:hover .latest-msg-time,.channel-container .channel:hover .latest-msg,.channel-container .channel:hover .latest-msg.new{color:rgb(var(--dyte-colors-text-on-brand-700, var(--dyte-colors-text-700, 255 255 255 / 0.64)))}.channel-container .channel-display{display:flex;gap:var(--dyte-space-2, 8px);align-self:center;padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-0, 0px)}.channel-container .channel-display dyte-avatar{height:var(--dyte-space-9, 36px);width:var(--dyte-space-9, 36px);flex-shrink:0;font-size:12px}.channel-container .channel-display dyte-icon{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);flex-shrink:0;padding:var(--dyte-space-2, 8px);border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.channel-container .channel-card{width:100%;padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);padding-left:var(--dyte-space-1, 4px)}.channel-container .channel-card span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:14px;font-weight:500}.channel-container .channel-card .latest-msg{margin:var(--dyte-space-0, 0px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:var(--dyte-space-56, 224px);font-size:14px}.channel-container .channel-card .latest-msg.new{font-weight:200;font-style:italic;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.channel-container .channel-card .latest-msg-time{font-size:12px;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.channel-container .channel-meta{width:var(--dyte-space-12, 48px);display:flex;flex-direction:column;align-items:flex-end;justify-content:space-between;gap:var(--dyte-space-1\\.5, 6px);font-size:12px;font-weight:600}.channel-container .new-msgs-count{height:var(--dyte-space-4, 16px);min-width:var(--dyte-space-4, 16px);padding-top:1px;padding-bottom:1px;padding-left:2px;padding-right:2px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));border-radius:var(--dyte-border-radius-sm, 4px);text-align:center;font-size:12px}.channel-container .selected{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-900, var(--dyte-colors-text-900, 255 255 255 / 0.88)))}.channel-container .selected .latest-msg-time,.channel-container .selected .latest-msg,.channel-container .selected .latest-msg.new{color:rgb(var(--dyte-colors-text-on-brand-700, var(--dyte-colors-text-700, 255 255 255 / 0.64)))}.channel-container .highlight .channel-title span{font-weight:700}.recent-message-row{margin-bottom:var(--dyte-space-2, 8px);display:flex;width:100%;flex-direction:row;justify-content:space-between}";const w="@",x=class{constructor(e){(0,a.r)(this,e),this.onNewMessage=(0,a.c)(this,"dyteNewMessage",7),this.onEditMessage=(0,a.c)(this,"dyteEditMessage",7),this.onEditCancelled=(0,a.c)(this,"dyteEditCancelled",7),this.fileReader=new FileReader,this.fileToUpload=null,this.handleKeyDown=e=>{if(e.key===w&&(this.mentionQuery=w),"ArrowDown"===e.key&&(this.focusedMemberIndex=Math.min(this.focusedMemberIndex+1,this.getFilteredMembers().length-1)),"ArrowUp"===e.key&&(this.focusedMemberIndex=Math.max(0,this.focusedMemberIndex-1)),("Escape"===e.key||"Backspace"===e.key&&this.mentionQuery===w)&&(this.mentionQuery=""),["Enter","Tab"," "].includes(e.key)&&""!==this.mentionQuery){const t=this.getFilteredMembers()[this.focusedMemberIndex];return this.onMemberSelect(t),void e.preventDefault()}if("Enter"===e.key&&e.shiftKey){this.$textArea.clientHeight<200&&(this.$textArea.style.height=this.$textArea.clientHeight+20+"px")}else"Enter"===e.key?(e.preventDefault(),this.prefill.editMessage?this.handleEditMessage():this.handleSendMessage()):"Backspace"===e.key&&(this.$textArea.value.endsWith("\n")?this.$textArea.style.height=this.$textArea.clientHeight-20+"px":""===this.$textArea.value&&(this.$textArea.style.height="auto"))},this.handleKeyUp=e=>{if(""!==this.mentionQuery){const e=(0,c.r)(this.$textArea.value.trim()),t=e.substring(0,e.indexOf(w));this.mentionQuery=`@${(0,c.r)(t)}`}},this.onPaste=e=>{const t=e.clipboardData||e.originalEvent.clipboardData;(0,c.h)(t.items,this.generateFilePreview),(0,a.w)((()=>{t.items.length>0&&(this.$textArea.value="")}))},this.generateFilePreview=(e,t)=>{this.fileToUpload={type:e,image:t,file:t},"image"===e?this.fileReader.readAsDataURL(t):"file"===e&&(this.filePreview=t.name)},this.sendFile=()=>{this.canSendFiles&&("image"===this.fileToUpload.type?this.onNewMessage.emit({type:"image",file:this.fileToUpload.image,image:this.fileToUpload.image}):this.onNewMessage.emit({type:"file",file:this.fileToUpload.file}),this.cleanUpFileUpload())},this.handleSendMessage=()=>{if(!this.canSendTextMessage)return;if(null!==this.fileToUpload)return void this.sendFile();const e=this.$textArea.value.trim();e.length>0&&(this.prefill.replyMessage?this.onNewMessage.emit({type:"text",message:e,replyTo:this.prefill.replyMessage}):this.onNewMessage.emit({type:"text",message:e}),this.cleanup())},this.cleanup=()=>{this.mentionQuery="",this.focusedMemberIndex=0,this.$textArea.value="",this.$textArea.style.height="auto",n.g.setItem("dyte-text-message","")},this.handleEditMessage=()=>{this.onEditMessage.emit({id:this.prefill.editMessage.id,message:this.$textArea.value.trim(),channelId:this.prefill.editMessage.channelId}),this.cleanup()},this.handleEditCancel=()=>{this.onEditCancelled.emit(),this.cleanup()},this.initializeTextField=e=>{this.$textArea=e;const t=n.g.getItem("dyte-text-message")||"";this.$textArea.value=t},this.onMemberSelect=e=>{const t=(0,c.r)(this.mentionQuery),i=(0,c.r)(this.$textArea.value.trim()).replace(t,"");this.$textArea.value=(0,c.r)(i)+`@${e.name} `,this.mentionQuery="",this.focusedMemberIndex=0,(0,a.w)((()=>this.$textArea.focus()))},this.getFilteredMembers=()=>{const e=this.mentionQuery.replace(w,"");return this.members.filter((t=>t.name.toLowerCase().includes(e.toLowerCase())))},this.cleanUpFileUpload=()=>{this.filePreview=null,this.fileToUpload=null},this.renderSuggestedReplies=()=>{if(this.prefill.suggestedReplies&&0!==this.prefill.suggestedReplies.length)return(0,a.h)("ul",{class:"suggested-replies scrollbar"},this.prefill.suggestedReplies.map((e=>(0,a.h)("dyte-tooltip",{label:this.t("chat.click_to_send")},(0,a.h)("li",{onClick:()=>this.onNewMessage.emit({type:"text",message:e})},e)))))},this.renderMenu=()=>{if(0===this.mentionQuery.length)return;const e=this.getFilteredMembers();return 0!==e.length?(0,a.h)("ul",{class:"member-list scrollbar"},e.map(((e,t)=>(0,a.h)("li",{class:{member:!0,selected:t===this.focusedMemberIndex},onClick:()=>this.onMemberSelect(e),ref:e=>{t===this.focusedMemberIndex&&(0,a.w)((()=>{e&&e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}))}},(0,a.h)("dyte-avatar",{participant:{name:e.name,picture:e.picture},size:"sm"}),(0,a.h)("span",null,e.name))))):void 0},this.canSendTextMessage=!1,this.canSendFiles=!1,this.size=void 0,this.iconPack=o.d,this.t=(0,r.u)(),this.disableEmojiPicker=!1,this.prefill={},this.members=[],this.emojiPickerActive=!1,this.mentionQuery="",this.focusedMemberIndex=0,this.filePreview=null}connectedCallback(){this.fileReader.onload=e=>{"string"==typeof e.target.result&&(this.filePreview=e.target.result)}}componentDidRender(){(this.prefill.editMessage||this.prefill.replyMessage)&&(0,a.w)((()=>this.$textArea.focus()))}uploadFile(e){const t=document.createElement("input");t.type="file","image"===e&&(t.accept="image/*"),t.onchange=t=>{const{validity:i,files:[a]}=t.target;i.valid&&this.generateFilePreview(e,a)},t.click()}renderFilePreview(){if("string"==typeof this.filePreview)return(0,a.h)("div",{class:"preview-overlay"},(0,a.h)("div",{class:"file-preview"},(0,a.h)("dyte-tooltip",{label:this.t("chat.cancel_upload")},(0,a.h)("dyte-button",{variant:"secondary",kind:"icon",onClick:this.cleanUpFileUpload},(0,a.h)("dyte-icon",{icon:this.iconPack.dismiss}))),"image"===this.fileToUpload.type?(0,a.h)("img",{class:"preview-image",src:this.filePreview}):(0,a.h)("div",{class:"preview-file"},(0,a.h)("span",null,this.filePreview))))}render(){var e;const t={iconPack:this.iconPack,t:this.t,size:this.size},i=null===(e=this.prefill.editMessage)||void 0===e?void 0:e.message;return(0,a.h)(a.H,null,this.canSendTextMessage&&this.emojiPickerActive&&(0,a.h)("dyte-emoji-picker",{part:"emoji-picker",onDyteEmojiClicked:e=>{this.$textArea.value+=e.detail,this.$textArea.focus()},t:this.t}),this.renderSuggestedReplies(),(0,a.h)("slot",{name:"chat-addon"}),(0,a.h)("div",{class:"chat-input",part:"chat-input"},this.renderMenu(),this.canSendTextMessage&&(0,a.h)("textarea",{class:"scrollbar",part:"textarea",ref:this.initializeTextField,autoFocus:!0,placeholder:this.fileToUpload?"":this.t("chat.message_placeholder"),value:i,onPaste:this.onPaste,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onInput:e=>{n.g.setItem("dyte-text-message",e.target.value)},disabled:!!this.filePreview}),(0,a.h)("div",{class:"chat-buttons",part:"chat-buttons"},(0,a.h)("div",{class:"left",part:"chat-buttons-left"},!this.prefill.editMessage&&this.canSendFiles&&[(0,a.h)("dyte-tooltip",Object.assign({label:this.t("chat.send_file")},t),(0,a.h)("dyte-button",{variant:"ghost",kind:"icon",onClick:()=>this.uploadFile("file"),title:this.t("chat.send_file"),iconPack:this.iconPack,t:this.t},(0,a.h)("dyte-icon",{icon:this.iconPack.attach}))),(0,a.h)("dyte-tooltip",Object.assign({label:this.t("chat.send_img")},t),(0,a.h)("dyte-button",{variant:"ghost",kind:"icon",onClick:()=>this.uploadFile("image"),title:this.t("chat.send_img"),iconPack:this.iconPack,t:this.t},(0,a.h)("dyte-icon",{icon:this.iconPack.image})))],!this.prefill.editMessage&&this.canSendTextMessage&&!this.disableEmojiPicker&&(0,a.h)("dyte-tooltip",Object.assign({label:this.t("chat.send_emoji")},t),(0,a.h)("dyte-button",{variant:"ghost",kind:"icon",class:{active:this.emojiPickerActive},title:this.t("chat.send_emoji"),iconPack:this.iconPack,t:this.t,onClick:()=>{this.emojiPickerActive=!this.emojiPickerActive}},(0,a.h)("dyte-icon",{icon:this.iconPack.emoji_multiple})))),!!this.filePreview&&this.renderFilePreview(),this.canSendTextMessage&&(0,a.h)("div",{class:"right",part:"chat-buttons-right"},!this.prefill.editMessage&&(0,a.h)("dyte-tooltip",Object.assign({variant:"primary",label:this.t("chat.send_msg"),delay:2e3},t),(0,a.h)("dyte-button",{kind:"icon",onClick:()=>this.handleSendMessage(),title:this.t("chat.send_msg"),iconPack:this.iconPack,t:this.t},(0,a.h)("dyte-icon",{icon:this.iconPack.send}))),this.prefill.editMessage&&(0,a.h)("div",{class:"edit-buttons"},(0,a.h)("dyte-tooltip",Object.assign({variant:"secondary",label:this.t("cancel"),delay:2e3},t),(0,a.h)("dyte-button",{kind:"icon",variant:"secondary",onClick:()=>this.handleEditCancel(),title:this.t("cancel"),iconPack:this.iconPack,t:this.t},(0,a.h)("dyte-icon",{icon:this.iconPack.dismiss}))),(0,a.h)("dyte-tooltip",Object.assign({variant:"primary",label:this.t("chat.update_msg"),delay:2e3},t),(0,a.h)("dyte-button",{kind:"icon",onClick:()=>this.handleEditMessage(),title:this.t("chat.send_msg"),iconPack:this.iconPack,t:this.t},(0,a.h)("dyte-icon",{icon:this.iconPack.checkmark}))))))))}};x.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}.chat-input{position:relative;margin:var(--dyte-space-2, 8px);z-index:10;box-sizing:border-box;display:flex;flex-direction:column;border-radius:var(--dyte-border-radius-md, 8px);border:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60))}textarea{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));box-sizing:border-box;padding:var(--dyte-space-3, 12px);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}textarea::-moz-placeholder{color:rgb(var(--dyte-colors-text-1000, 255 255 255))}textarea::placeholder{color:rgb(var(--dyte-colors-text-1000, 255 255 255))}textarea{border-top-left-radius:var(--dyte-border-radius-md, 8px);border-top-right-radius:var(--dyte-border-radius-md, 8px);font-family:var(--dyte-font-family, sans-serif);outline:2px solid transparent;outline-offset:2px;resize:none;overflow-y:auto;border-width:var(--dyte-border-width-none, 0);border-style:none;min-height:60px;font-size:14px}.chat-buttons{border-bottom-right-radius:var(--dyte-border-radius-md, 8px);border-bottom-left-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));display:flex;height:var(--dyte-space-8, 32px);align-items:center;justify-content:space-between;padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px)}.chat-buttons .left dyte-button{margin-right:var(--dyte-space-1, 4px)}.chat-buttons .left dyte-button dyte-icon{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px)}.chat-buttons .right{z-index:10}.chat-buttons .right .edit-buttons{display:flex;gap:var(--dyte-space-2, 8px)}.chat-buttons>div{display:flex;align-items:center}dyte-emoji-picker{z-index:0;border-top:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));-webkit-animation:0.3s slide-up ease;animation:0.3s slide-up ease}@-webkit-keyframes slide-up{from{transform:translateY(100%)}to{transform:translateY(0%)}}@keyframes slide-up{from{transform:translateY(100%)}to{transform:translateY(0%)}}.member-list{margin:var(--dyte-space-0, 0px);margin-top:var(--dyte-space-1, 4px);max-height:var(--dyte-space-28, 112px);min-width:var(--dyte-space-40, 160px);max-width:var(--dyte-space-64, 256px);padding:var(--dyte-space-0, 0px);position:absolute;bottom:var(--dyte-space-28, 112px);list-style-type:none;overflow-y:auto;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));border-radius:var(--dyte-border-radius-sm, 4px);--tw-border-spacing-x:var(--dyte-space-2, 8px);--tw-border-spacing-y:var(--dyte-space-2, 8px);border-spacing:var(--tw-border-spacing-x) var(--tw-border-spacing-y);border-style:solid;border-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}.member-list .member{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);padding:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-4, 16px);cursor:pointer}.member-list .member dyte-avatar{flex-shrink:0;height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);font-size:14px;color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.member-list .member span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.member-list .member:hover,.member-list .member.selected{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-700, 2 70 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.suggested-replies{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-3, 12px);display:flex;flex-wrap:nowrap;gap:var(--dyte-space-2, 8px);list-style-type:none;overflow-x:auto}.suggested-replies dyte-tooltip{flex-shrink:0}.suggested-replies li{padding:var(--dyte-space-2, 8px);border-radius:var(--dyte-border-radius-md, 8px);background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.75);color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));cursor:pointer}.suggested-replies li:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity))}.preview-overlay{position:absolute;top:var(--dyte-space-0, 0px);right:var(--dyte-space-0, 0px);bottom:var(--dyte-space-0, 0px);left:var(--dyte-space-0, 0px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));border-radius:var(--dyte-border-radius-md, 8px)}.file-preview{position:absolute;top:var(--dyte-space-4, 16px);right:var(--dyte-space-4, 16px);bottom:var(--dyte-space-4, 16px);left:var(--dyte-space-4, 16px);max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content;height:var(--dyte-space-20, 80px)}.file-preview dyte-tooltip{position:absolute;top:calc(var(--dyte-space-1, 4px) * -1);left:calc(var(--dyte-space-1, 4px) * -1);margin-left:calc(var(--dyte-space-1, 4px) * -1);margin-top:calc(var(--dyte-space-1, 4px) * -1)}.file-preview dyte-button{display:flex;height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);align-items:center;justify-content:center;border-radius:9999px;border:2px solid rgb(var(--dyte-colors-background-1000, 8 8 8))}.file-preview dyte-icon{height:var(--dyte-space-3, 12px);width:var(--dyte-space-3, 12px)}.preview-image{height:var(--dyte-space-16, 64px);width:var(--dyte-space-16, 64px);-o-object-fit:cover;object-fit:cover;max-height:100%;max-width:100%;overflow:clip;border-radius:var(--dyte-border-radius-md, 8px)}.preview-file{padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px);padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));overflow:hidden;text-overflow:ellipsis;white-space:nowrap;border-radius:var(--dyte-border-radius-md, 8px)}.preview-file:hover span,.preview-file:focus span{display:inline-block;-webkit-animation:scroll-text 12s ease 0s infinite normal;animation:scroll-text 12s ease 0s infinite normal}@-webkit-keyframes scroll-text{0%{transform:translateX(0%)}70%{transform:translateX(-100%)}80%{transform:translateX(0%)}100%{transform:translateX(0%)}}@keyframes scroll-text{0%{transform:translateX(0%)}70%{transform:translateX(-100%)}80%{transform:translateX(0%)}100%{transform:translateX(0%)}}";const k=class{constructor(e){(0,a.r)(this,e),this.observingEl=[],this.onScroll=e=>{const t=e.target;(0,a.w)((()=>{const{scrollTop:e,clientHeight:i,scrollHeight:a}=t;e+i+10>=a?(this.autoScrollEnabled=!0,this.showLatestMessageButton=!1):this.autoScrollEnabled=!1}))},this.scrollToBottom=()=>{(0,h.s)(this.$chat)},this.observeMessage=e=>{e&&this.observingEl.push(e);try{this.intersectionObserver.observe(e)}catch(t){}},this.selectedGroup=void 0,this.messages=[],this.selfUserId=void 0,this.size=void 0,this.iconPack=o.d,this.t=(0,r.u)(),this.now=new Date,this.showLatestMessageButton=!1}connectedCallback(){var e;this.lastReadTimestamp=null!==(e=d.c.everyone)&&void 0!==e?e:new Date("0001-01-01T00:00:00Z"),this.intersectionObserver=new IntersectionObserver((e=>{document.hasFocus()&&(0,a.w)((()=>{for(const t of e)if(t.isIntersecting){parseInt(t.target.getAttribute("data-timestamp"))>this.lastReadTimestamp.getTime()&&(d.c[this.selectedGroup]=new Date)}}))}));const t=()=>{this.now=new Date,this.timeout=setTimeout((()=>{null!=this.request&&(this.request=requestAnimationFrame(t))}),6e4)};this.request=requestAnimationFrame(t),this.chatChanged(this.messages)}componentDidLoad(){this.$chat.addEventListener("scroll",this.onScroll)}componentDidRender(){this.autoScrollEnabled?(0,h.s)(this.$chat):null==this.autoScrollEnabled&&(0,h.s)(this.$chat,!1)}chatChanged(e){if(null!=this.$chat&&!this.autoScrollEnabled&&this.$chat.clientHeight!==this.$chat.scrollHeight)for(let t=e.length-1;t>=0;t--)if(e[t].message.time>this.lastReadTimestamp&&e[t].message.userId!==this.selfUserId){this.showLatestMessageButton=!0;break}}selectedBucketChanged(){this.autoScrollEnabled=void 0,this.observingEl.forEach((e=>{this.intersectionObserver.unobserve(e)})),this.observingEl=[]}disconnectedCallback(){this.$chat.removeEventListener("scroll",this.onScroll),this.intersectionObserver.disconnect(),clearTimeout(this.timeout),cancelAnimationFrame(this.request)}render(){var e;let t=null,i=!1;return(0,a.h)(a.H,null,(0,a.h)("div",{class:"chat-container scrollbar",ref:e=>this.$chat=e,part:"container"},(0,a.h)("div",{class:"spacer",part:"spacer"}),(0,a.h)("div",{class:"chat",part:"chat"},null===(e=this.messages)||void 0===e?void 0:e.map((e=>{if("chat"===e.type){const{message:s}=e,o=!(s.userId===this.selfUserId)&&!this.autoScrollEnabled&&!i&&s.time>this.lastReadTimestamp;o&&(i=o);const r=!o&&s.userId===(null==t?void 0:t.userId)&&(0,l.d)(s.time,null==t?void 0:t.time)<2;switch(t=s,s.type){case"text":return(0,a.h)("div",{"is-continued":r,key:e.message.id},o&&(0,a.h)("div",{class:"new-chat-marker",part:"new-chat-marker"},this.t("chat.new")),(0,a.h)("dyte-text-message",{message:s,now:this.now,isContinued:r,"data-timestamp":s.time.getTime(),ref:this.observeMessage,iconPack:this.iconPack,t:this.t}));case"image":return(0,a.h)("div",{"is-continued":r,key:e.message.id},o&&(0,a.h)("div",{class:"new-chat-marker",part:"new-chat-marker"},this.t("chat.new")),(0,a.h)("dyte-image-message",{message:s,now:this.now,isContinued:r,iconPack:this.iconPack,"data-timestamp":s.time.getTime(),ref:this.observeMessage,t:this.t}));case"file":return(0,a.h)("div",{"is-continued":r,key:e.message.id},o&&(0,a.h)("div",{class:"new-chat-marker",part:"new-chat-marker"},this.t("chat.new")),(0,a.h)("dyte-file-message",{message:s,now:this.now,isContinued:r,iconPack:this.iconPack,t:this.t,"data-timestamp":s.time.getTime(),ref:this.observeMessage}))}}return null})))),(0,a.h)("div",{class:"show-new-messages-ctr"},(0,a.h)("dyte-button",{class:{"show-new-messages":!0,active:this.showLatestMessageButton},kind:"icon",part:"show-new-messages",onClick:this.scrollToBottom,iconPack:this.iconPack,t:this.t},(0,a.h)("dyte-icon",{icon:this.iconPack.chevron_down,iconPack:this.iconPack,t:this.t}))))}static get watchers(){return{messages:["chatChanged"],selectedGroup:["selectedBucketChanged"]}}};k.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;display:flex;flex-direction:column;word-break:break-word}.chat-container{box-sizing:border-box;display:flex;flex-direction:column;padding-top:var(--dyte-space-4, 16px);padding-bottom:var(--dyte-space-4, 16px);flex:1 0 0px;overflow-y:scroll}.chat-container .spacer{flex:1 1 auto}.chat-container .chat{flex:0 0 auto}.file-picker{display:none}.chat *:first-child{margin-top:var(--dyte-space-0, 0px)}.chat .head{display:flex;align-items:center}.chat .head .name{margin-right:var(--dyte-space-4, 16px);font-size:12px;font-weight:700}.chat .head .time{font-size:12px;color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.chat .body{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);overflow-wrap:break-word;font-size:14px;line-height:1.375}.chat .body .emoji{font-size:24px}p{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px)}dyte-text-message,dyte-image-message,dyte-file-message{margin-top:var(--dyte-space-4, 16px);display:block;padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));box-sizing:border-box}*[is-continued]{margin-top:var(--dyte-space-3, 12px)}dyte-text-message[is-continued]{margin-top:var(--dyte-space-2, 8px)}.chat .image{position:relative;height:var(--dyte-space-40, 160px);max-width:var(--dyte-space-64, 256px);cursor:pointer}.chat .image img{display:none;height:100%;width:100%;border-radius:var(--dyte-border-radius-sm, 4px);-o-object-fit:cover;object-fit:cover}.chat .image .image-spinner{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.chat .image .image-spinner dyte-spinner{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}.chat .image .image-errored{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-sm, 4px);background-color:rgba(var(--dyte-colors-danger, 255 45 45) / 0.1);--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}.chat .image .actions{display:none;height:var(--dyte-space-8, 32px);align-items:center;position:absolute;top:var(--dyte-space-2, 8px);right:var(--dyte-space-2, 8px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden;--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.chat .image .actions .action{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);border-radius:var(--dyte-border-radius-none, 0);border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:transparent;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.chat .image .actions .action:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.image.loaded img{display:block}.image.loaded .image-spinner{display:none}.image:hover .actions,.image:focus .actions{display:flex}.chat .file{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);padding-top:var(--dyte-space-1\\.5, 6px);padding-bottom:var(--dyte-space-1\\.5, 6px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.chat .file .file-data{flex:1 1 0%}.chat .file .file-data .name{word-break:break-all;color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.chat .file .file-data .file-data-split{margin-top:var(--dyte-space-0\\.5, 2px);display:flex;align-items:center;font-size:12px}.chat .file .file-data .file-data-split .ext{margin-right:var(--dyte-space-2, 8px);text-transform:uppercase;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.chat .file .file-data .file-data-split .divider{height:var(--dyte-space-4, 16px);width:var(--dyte-space-0\\.5, 2px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.chat .file .file-data .file-data-split .size{margin-left:var(--dyte-space-2, 8px)}a{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity));-webkit-text-decoration-line:none;text-decoration-line:none}a:hover{-webkit-text-decoration-line:underline;text-decoration-line:underline}.new-chat-marker{display:flex;width:100%;align-items:center;gap:var(--dyte-space-2, 8px);--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity))}.new-chat-marker::before{content:'';height:1px;flex:1 1 0%;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}.show-new-messages-ctr{pointer-events:none;display:flex;justify-content:flex-end;padding:var(--dyte-space-3, 12px);z-index:0;margin-top:calc(var(--dyte-space-14, 56px) * -1)}.show-new-messages{pointer-events:auto;--tw-translate-y:calc(var(--dyte-space-6, 24px) * -1);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:0;transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.show-new-messages.active{--tw-translate-y:var(--dyte-space-0, 0px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:1}";const P=class{constructor(e){(0,a.r)(this,e),this.editMessageInit=(0,a.c)(this,"editMessageInit",7),this.pageSize=25,this.lastReadMessageIndex=-1,this.maybeMarkChannelAsRead=e=>{if(!this.selectedChannelId)return;if(0===e.length)return;if(-1!==this.lastReadMessageIndex)return;const t=e.at(0).time>e.at(-1).time?e.at(0):e.at(-1);t.channelIndex&&(this.lastReadMessageIndex=parseInt(t.channelIndex,10),this.meeting.chat.markLastReadMessage(this.selectedChannelId,t))},this.getChatMessages=async(e,t,i)=>{const{messages:a}=await this.meeting.chat.getMessages(e,t,i,void 0,this.selectedChannelId);return this.maybeMarkChannelAsRead(a),a},this.createChatNodes=e=>e.map(((t,i)=>{var a;const s=t.userId===(null===(a=e[i-1])||void 0===a?void 0:a.userId);return this.createChatNode(t,s)})),this.disconnectMeeting=e=>{var t;null===(t=null==e?void 0:e.chat)||void 0===t||t.removeListener("chatUpdate",this.chatUpdateListener)},this.createChatNode=(e,t)=>{var i,s;const o=this.meeting.self.userId===e.userId;return(0,a.h)("dyte-chat-message",{message:e,isContinued:t,isUnread:!1,size:this.size,iconPack:this.iconPack,key:e.id,isSelf:o,alignRight:o&&"CHAT"===this.meeting.meta.viewType,disableControls:"CHAT"!==this.meeting.meta.viewType,senderDisplayPicture:null===(i=this.meeting.participants.all.find((t=>t.id===e.userId)))||void 0===i?void 0:i.picture,hideAvatar:o&&"CHAT"===this.meeting.meta.viewType||(null===(s=this.selectedChannel)||void 0===s?void 0:s.isDirectMessage),canEdit:o&&"text"===e.type,canDelete:o,onEdit:()=>{"text"===e.type&&this.editMessageInit.emit({payload:e,flags:{isEdit:!0}})},onReply:()=>{"text"===e.type&&this.editMessageInit.emit({payload:e,flags:{isReply:!0}})},onDelete:async()=>{var t;await this.meeting.chat.deleteMessage(e.id,null===(t=this.selectedChannel)||void 0===t?void 0:t.id).catch((()=>{}))}})},this.chatUpdateListener=e=>{this.selectedChannelId&&e.message.channelId!==this.selectedChannelId||("add"===e.action?(this.$paginatedListRef.onNewNode(e.message),this.lastReadMessageIndex=-1,this.maybeMarkChannelAsRead([e.message])):"delete"===e.action?this.$paginatedListRef.onNodeDelete(e.message.id):"edit"===e.action&&this.$paginatedListRef.onNodeUpdate(e.message.id,e.message))},this.meeting=void 0,this.selectedChannel=void 0,this.selectedChannelId=void 0,this.size=void 0,this.iconPack=o.d,this.t=(0,r.u)()}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.disconnectMeeting(this.meeting)}meetingChanged(e,t){var i;null!=t&&this.disconnectMeeting(t),e&&!e.chat||null!=e&&(null===(i=e.chat)||void 0===i||i.addListener("chatUpdate",this.chatUpdateListener))}channelChanged(){this.lastReadMessageIndex=-1}render(){return(0,a.h)(a.H,null,(0,a.h)("dyte-paginated-list",{ref:e=>this.$paginatedListRef=e,pageSize:this.pageSize,pagesAllowed:3,fetchData:this.getChatMessages,createNodes:this.createChatNodes,selectedItemId:this.selectedChannelId,emptyListLabel:this.t("chat.empty_channel")}))}static get watchers(){return{meeting:["meetingChanged"],selectedChannelId:["channelChanged"]}}};P.style=":host{display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));flex:1 0 0px}";const C=class{constructor(e){(0,a.r)(this,e),this.pageSize=50,this.searchMessages=async(e,t,i)=>this.meeting.chat.searchMessages(this.query,{channelId:this.channelId,timestamp:e,size:t,reversed:i}),this.nodeRenderer=e=>e.map((e=>(0,a.h)("dyte-chat-message",{key:e.id,message:e,disableControls:!0}))),this.meeting=void 0,this.query=void 0,this.channelId=void 0,this.iconPack=o.d,this.t=(0,r.u)()}render(){return(0,a.h)(a.H,null,(0,a.h)("dyte-paginated-list",{pageSize:this.pageSize,pagesAllowed:3,fetchData:this.searchMessages,createNodes:this.nodeRenderer,selectedItemId:this.query}))}};C.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;height:100%;flex-direction:column;position:relative;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}";const _=class{constructor(e){(0,a.r)(this,e),this.groupChanged=(0,a.c)(this,"dyteChatGroupChanged",7),this.onScopeClick=e=>{this.showParticipantsPanel=!1,this.groupChanged.emit(e)},this.selfUserId=void 0,this.selectedGroupId=void 0,this.unreadCounts={},this.groups=[],this.iconPack=o.d,this.t=(0,r.u)(),this.showParticipantsPanel=!1,this.query=""}toggleParticipants(){this.showParticipantsPanel=!this.showParticipantsPanel}getGroups(){return this.groups.filter((e=>e.name.toLowerCase().includes(this.query.toLowerCase())))}getName(){if(!this.selectedGroupId||"everyone"===this.selectedGroupId)return this.t("everyone");const e=this.groups.find((e=>e.userId===this.selectedGroupId));return e?e.name:this.t("everyone")}render(){const e=Object.keys(this.unreadCounts).reduce(((e,t)=>e+this.unreadCounts[t]),0);return(0,a.h)(a.H,null,(0,a.h)("div",{class:"chat-scope-selector"},this.showParticipantsPanel&&(0,a.h)("div",{class:"participants-container"},(0,a.h)("div",{class:"search",part:"search"},(0,a.h)("dyte-icon",{icon:this.iconPack.search,part:"search-icon"}),(0,a.h)("input",{type:"search",autocomplete:"off",placeholder:"Search",value:this.query,onInput:e=>{this.query=e.target.value},part:"search-input"})),(0,a.h)("ul",{class:"scope-list scrollbar"},""===this.query&&(0,a.h)("li",{class:"scope scope-special",onClick:()=>this.onScopeClick("everyone")},(0,a.h)("div",{class:"everyone-icon"},(0,a.h)("dyte-icon",{icon:this.iconPack.participants})),"Everyone",this.unreadCounts.everyone>0&&(0,a.h)("div",{class:"unread-count",part:"unread-count"},(0,a.h)("span",null,this.unreadCounts.everyone))),this.getGroups().map((e=>{const t=this.unreadCounts[(0,c.g)([this.selfUserId,e.userId])];return(0,a.h)("li",{class:"scope",onClick:()=>this.onScopeClick(e),key:e.userId},e.name,t>0&&(0,a.h)("div",{class:"unread-count",part:"unread-count"},(0,a.h)("span",null,t)))})))),(0,a.h)("button",{onClick:()=>this.toggleParticipants()},(0,a.h)("span",null,`${this.t("to")} ${this.getName()}`,"  ",e>0&&(0,a.h)("div",{class:"unread-count selector"},(0,a.h)("span",null,e))),(0,a.h)("dyte-icon",{icon:this.showParticipantsPanel?this.iconPack.chevron_up:this.iconPack.chevron_down}))))}};_.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{display:flex;flex-direction:column}.chat-scope-selector{position:relative;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));z-index:10}.chat-scope-selector button{width:100%;border-width:var(--dyte-border-width-none, 0);border-style:none;padding:var(--dyte-space-4, 16px);display:flex;align-items:center;justify-content:space-between;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));font-size:14px;cursor:pointer;height:var(--dyte-space-12, 48px)}.chat-scope-selector button span{display:flex;align-items:center;justify-content:flex-start}.chat-scope-selector button dyte-icon{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px)}.chat-scope-selector .search{position:-webkit-sticky;position:sticky;box-sizing:border-box;display:flex;align-items:center;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));margin-left:var(--dyte-space-3, 12px);margin-right:var(--dyte-space-3, 12px);margin-top:var(--dyte-space-3, 12px);margin-bottom:var(--dyte-space-0, 0px)}.chat-scope-selector .search dyte-icon{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}.chat-scope-selector .search input{box-sizing:border-box;height:var(--dyte-space-9, 36px);width:100%;padding-right:var(--dyte-space-2, 8px);border-width:var(--dyte-border-width-none, 0);border-style:none;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));outline:2px solid transparent;outline-offset:2px;border-radius:var(--dyte-border-radius-sm, 4px);font-size:14px}.chat-scope-selector .search input::-moz-placeholder{color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.chat-scope-selector .search input::placeholder{color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.chat-scope-selector .participants-container{position:absolute;width:100%;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));top:var(--dyte-space-12, 48px);-webkit-animation:0.3s slide-down ease;animation:0.3s slide-down ease}@-webkit-keyframes slide-down{from{transform:translateY(-50px)}to{transform:translateY(0%)}}@keyframes slide-down{from{transform:translateY(-50px)}to{transform:translateY(0%)}}.chat-scope-selector .scope-list{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-0, 0px);list-style-type:none;padding-left:var(--dyte-space-0, 0px);padding-right:var(--dyte-space-0, 0px);overflow:auto;max-height:375px}.chat-scope-selector .scope-list .scope{position:relative;display:flex;flex-direction:row;align-items:center;padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);padding-top:var(--dyte-space-4, 16px);padding-bottom:var(--dyte-space-4, 16px)}.chat-scope-selector .scope-list .scope:hover{cursor:pointer;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}.chat-scope-selector .scope-list .scope-special{margin-top:var(--dyte-space-4, 16px);--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}.chat-scope-selector .scope-list .everyone-icon>dyte-icon{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px);color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.chat-scope-selector .scope-list .everyone-icon{display:flex;height:100%;width:100%;align-items:center;justify-content:center;margin-right:var(--dyte-space-2, 8px);height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));font-size:12px}.unread-count.selector{position:unset;margin-left:var(--dyte-space-2, 8px)}.unread-count{position:absolute;right:var(--dyte-space-3, 12px);box-sizing:border-box;padding:var(--dyte-space-0\\.5, 2px);-webkit-user-select:none;-moz-user-select:none;user-select:none;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));font-size:12px;color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));display:flex;height:var(--dyte-space-5, 20px);min-width:var(--dyte-space-5, 20px);align-items:center;justify-content:center;border-radius:9999px;z-index:1}dyte-avatar{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px)}";const R=class{constructor(e){(0,a.r)(this,e),this.stateUpdate=(0,a.c)(this,"dyteStateUpdate",7),this.onDyteDialogClose=(e,t)=>{u.s[e]=t,this.stateUpdate.emit({[e]:t})},this.leaveStage=async()=>{var e,t,i;"LIVESTREAM"===this.meeting.meta.viewType&&"ACCEPTED_TO_JOIN_STAGE"===(null===(e=this.meeting.stage)||void 0===e?void 0:e.status)&&await(null===(i=null===(t=this.meeting)||void 0===t?void 0:t.stage)||void 0===i?void 0:i.leave()),"WEBINAR"===this.meeting.meta.viewType&&await this.meeting.self.leaveStage(),this.onDyteDialogClose("activeJoinStage",!1)},this.joinStage=async()=>{"LIVESTREAM"===this.meeting.meta.viewType&&await this.meeting.stage.join(),"WEBINAR"===this.meeting.meta.viewType&&await this.meeting.self.joinStage(),this.onDyteDialogClose("activeJoinStage",!1)},this.meeting=void 0,this.config=p.d,this.states=void 0,this.size=void 0,this.iconPack=o.d,this.t=(0,r.u)()}render(){var e,t,i,s;const o={meeting:this.meeting,states:this.states||u.s,config:this.config,size:this.size,iconPack:this.iconPack,t:this.t},r=this.states||u.s;if(null!=(null==r?void 0:r.image)){const e=r.image,t=()=>{this.stateUpdate.emit({image:null}),u.s.image=null};return(0,a.h)(a.H,null,(0,a.h)("dyte-dialog",{open:!0,onDyteDialogClose:t,hideCloseButton:!0,iconPack:this.iconPack,t:this.t},(0,a.h)(g.R,{element:"dyte-image-viewer",defaults:o,props:{image:e,onClose:t}})))}if(!0===(null==r?void 0:r.activeSettings))return(0,a.h)(a.H,null,(0,a.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.onDyteDialogClose("activeSettings",!1),iconPack:this.iconPack,t:this.t},(0,a.h)(g.R,{element:"dyte-settings",defaults:o})));if(!0===(null==r?void 0:r.activeLeaveConfirmation))return(0,a.h)(a.H,null,(0,a.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.onDyteDialogClose("activeLeaveConfirmation",!1),iconPack:this.iconPack,t:this.t},(0,a.h)(g.R,{element:"dyte-leave-meeting",defaults:o})));if(!0===(null===(e=null==r?void 0:r.activePermissionsMessage)||void 0===e?void 0:e.enabled))return(0,a.h)(a.H,null,(0,a.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.onDyteDialogClose("activePermissionsMessage",{enabled:!1}),iconPack:this.iconPack,t:this.t},(0,a.h)(g.R,{element:"dyte-permissions-message",defaults:o})));if(!0===(null==r?void 0:r.activeRemoteAccessManager))return(0,a.h)(a.H,null,(0,a.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.onDyteDialogClose("activeRemoteAccessManager",!1),iconPack:this.iconPack,t:this.t},(0,a.h)(g.R,{element:"dyte-remote-access-manager",defaults:o})));if(!0===(null===(t=null==r?void 0:r.activeBreakoutRoomsManager)||void 0===t?void 0:t.active))return(0,a.h)(a.H,null,(0,a.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.onDyteDialogClose("activeBreakoutRoomsManager",{active:!1,data:void 0}),iconPack:this.iconPack,t:this.t},(0,a.h)(g.R,{element:"dyte-breakout-rooms-manager",defaults:o,props:{mode:this.meeting.connectedMeetings.isActive?"view":"create"}})));if(!0===(null===(i=null==r?void 0:r.activeConfirmationModal)||void 0===i?void 0:i.active))return(0,a.h)(a.H,null,(0,a.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.onDyteDialogClose("activeConfirmationModal",!1),iconPack:this.iconPack,t:this.t},(0,a.h)(g.R,{element:"dyte-confirmation-modal",defaults:o})));if(!0===(null===(s=null==r?void 0:r.activeOverlayModal)||void 0===s?void 0:s.active))return(0,a.h)(a.H,null,(0,a.h)("dyte-overlay-modal",{meeting:this.meeting,states:this.states,iconPack:this.iconPack,t:this.t}));if(null==r?void 0:r.activeBroadcastMessageModal)return(0,a.h)(a.H,null,(0,a.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.onDyteDialogClose("activeBroadcastMessageModal",!1),iconPack:this.iconPack,t:this.t},(0,a.h)(g.R,{element:"dyte-broadcast-message-modal",defaults:o})));if(!0===(null==r?void 0:r.activeJoinStage)){const e={title:this.t("stage.join_title"),label:{accept:this.t("stage.join_confirm"),reject:this.t("stage.join_cancel")},description:this.t("stage.join_summary")};return(0,a.h)(a.H,null,(0,a.h)("dyte-dialog",{open:!0,onDyteDialogClose:this.leaveStage,iconPack:this.iconPack,t:this.t},(0,a.h)("dyte-join-stage",Object.assign({dataConfig:e,onDyteJoinStage:this.joinStage,onDyteLeaveStage:this.leaveStage},o))))}return!0===(null==r?void 0:r.activeMuteAllConfirmation)?(0,a.h)(a.H,null,(0,a.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.onDyteDialogClose("activeMuteAllConfirmation",!1)},iconPack:this.iconPack,t:this.t},(0,a.h)(g.R,{element:"dyte-mute-all-confirmation",defaults:o}))):(null==r?void 0:r.activeChannelCreator)?(0,a.h)(a.H,null,(0,a.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.onDyteDialogClose("activeChannelCreator",!1)},iconPack:this.iconPack,t:this.t},(0,a.h)(g.R,{element:"dyte-channel-creator",defaults:o}))):null}};R.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}";const L=2e3,S=Object.freeze({notifications:{participant_joined:!0,participant_left:!0,participant_joined_waitlist:!0,chat:!0,polls:!0,webinar:!0,tab_sync:!0},notification_sounds:{participant_joined:!0,participant_left:!0,chat:!0,polls:!0,webinar:!0,participant_joined_waitlist:!0},notification_duration:{participant_joined:2100,participant_left:2100,participant_joined_waitlist:4e3,chat:L,polls:L,webinar:L,tab_sync:L},participant_joined_sound_notification_limit:10,participant_chat_message_sound_notification_limit:10});function D(e){return Object.keys(e).filter((t=>e[t]))}const M=class{constructor(e){(0,a.r)(this,e),this.permissions=S,this.enabledSounds=D(S.notification_sounds),this.addStagePeersListeners=e=>{e.participants.joined.addListener("participantJoined",this.participantJoinedListener),e.meta.addListener("disconnected",this.networkDisconnectedListener),e.meta.addListener("connected",this.networkConnectedListener),e.participants.joined.addListener("participantLeft",this.participantLeftListener)},this.removeStagePeersListeners=e=>{e.participants.joined.removeListener("participantJoined",this.participantJoinedListener),e.meta.removeListener("disconnected",this.networkDisconnectedListener),e.meta.removeListener("connected",this.networkConnectedListener),e.participants.joined.removeListener("participantLeft",this.participantLeftListener)},this.onRemoteUpdate=({payload:e,type:t})=>{if(t===y.R.INCOMING_REQUEST_ACCEPTED){let t=this.meeting.participants.joined.get(e.request.remotePeerId);this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`Granted remote control to ${t.name}`,duration:L})}if(t===y.R.OUTGOING_REQUEST_ACCEPTED){let t=this.meeting.participants.joined.get(e.request.hostPeerId);this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`${t.name} has granted remote control.`,duration:L})}if(t===y.R.REQUEST_RECEIVED){let t=this.meeting.participants.joined.get(e.request.remotePeerId);this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`${t.name} has requested for remote control.`,duration:L})}if(t!==y.R.INCOMING_REQUEST_ENDED&&t!==y.R.OUTGOING_REQUEST_ENDED||this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:"Existing remote control has been terminated.",duration:L}),t===y.R.REQUEST_SENT){let t=this.meeting.participants.joined.get(e.request.hostPeerId);this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`Sent remote control request to ${t.name}`,duration:L})}},this.onDyteNotification=e=>{this.add(e.detail);const t=e.detail.playSound;null!=t&&this.audio.play(t)},this.onRecordingUpdate=e=>{"RECORDING"===e?this.add({id:"recording-started",icon:this.iconPack.recording,message:this.t("recording.started"),duration:L}):"STOPPING"===e&&this.add({id:"recording-stopped",icon:this.iconPack.stop_recording,message:this.t("recording.stopped"),duration:L})},this.meeting=void 0,this.states=void 0,this.config=p.d,this.t=(0,r.u)(),this.size=void 0,this.iconPack=o.d,this.notifications=[]}connectedCallback(){"undefined"!=typeof document&&(null===document||void 0===document||document.addEventListener("dyteNotification",this.onDyteNotification)),this.meetingChanged(this.meeting),this.configChanged(this.config),this.statesChanged(this.states)}clearListeners(e){var t,i,a,s,o,r,n,c,d;const l="LIVESTREAM"===e.meta.viewType;(l&&"ON_STAGE"===(null===(t=e.stage)||void 0===t?void 0:t.status)||!l)&&this.removeStagePeersListeners(e),this.chatUpdateListener&&(null===(i=e.chat)||void 0===i||i.removeListener("chatUpdate",this.chatUpdateListener)),this.pollUpdateListener&&(null===(a=e.polls)||void 0===a||a.removeListener("pollsUpdate",this.pollUpdateListener)),this.socketDisconnectedListener&&e.meta.removeListener("socketDisconnected",this.socketDisconnectedListener),this.socketReconnectFailureListener&&e.meta.removeListener("socketReconnectFailure",this.socketReconnectFailureListener),this.socketReconnectedListener&&e.meta.removeListener("socketReconnected",this.socketReconnectedListener),this.socketReconnectingListener&&e.meta.removeListener("socketReconnecting",this.socketReconnectingListener),this.socketFailureListener&&e.meta.removeListener("socketFailure",this.socketFailureListener),this.stageRequestAccepted&&(null===(s=e.stage)||void 0===s||s.removeListener("stageRequestApproved",this.stageRequestAccepted)),this.stageRequestRejected&&(null===(o=e.stage)||void 0===o||o.removeListener("stageRequestRejected",this.stageRequestRejected)),this.newStageRequests&&(null===(r=e.stage)||void 0===r||r.removeListener("newStageRequest",this.newStageRequests)),this.stageStatusUpdateListener&&(null===(n=e.stage)||void 0===n||n.removeListener("stageStatusUpdate",this.stageStatusUpdateListener)),null===(c=e.remote)||void 0===c||c.removeListener("remoteUpdate",this.onRemoteUpdate),null===(d=e.recording)||void 0===d||d.removeListener("recordingUpdate",this.onRecordingUpdate),clearTimeout(this.disconnectTimeout)}disconnectedCallback(){var e;"undefined"!=typeof document&&(null===document||void 0===document||document.removeEventListener("dyteNotification",this.onDyteNotification)),null!=this.meeting&&(this.clearListeners(this.meeting),this.waitlistedParticipantJoinedListener&&this.meeting.participants.waitlisted.removeListener("participantJoined",this.waitlistedParticipantJoinedListener),this.spotlightTabUpdateListener&&(null===(e=this.meeting.spotlight)||void 0===e||e.removeListener("activeTabUpdate",this.spotlightTabUpdateListener)),this.peerRequestToJoinStateListener&&this.meeting.participants.joined.removeListener("peerRequestToJoinStage",this.peerRequestToJoinStateListener),this.peerAcceptedToJoinStageListener&&this.meeting.participants.joined.removeListener("peerAcceptedToJoinStage",this.peerAcceptedToJoinStageListener),this.peerRejectedToJoinStageListener&&this.meeting.participants.joined.removeListener("peerRejectedToJoinStage",this.peerRejectedToJoinStageListener))}meetingChanged(e,t){var i,a,o,r,n,d,l,h,p;if(clearTimeout(this.disconnectTimeout),void 0!==t&&this.clearListeners(t),null==e)return;const g="LIVESTREAM"===e.meta.viewType;this.audio=new m.D;const{notifications:u,notification_duration:y,notification_sounds:b}=this.permissions;if(this.participantJoinedListener=e=>{u.participant_joined&&this.add({id:`${e.id}-joined`,message:`${(0,v.f)(e.name)} just joined`,image:e.picture,duration:y.participant_joined}),b.participant_joined&&this.canPlayParticipantJoinedSound()&&this.audio.play("joined")},this.participantLeftListener=e=>{u.participant_left&&this.add({id:`${e.id}-left`,message:`${(0,v.f)(e.name)} left`,image:e.picture,duration:y.participant_left}),b.participant_left&&this.canPlayParticipantJoinedSound()&&this.audio.play("left")},this.waitlistedParticipantJoinedListener=e=>{const t=`${e.id}-joined-waitlist`;this.add({id:t,message:`${(0,v.f)(e.name)} is requesting to join the meeting`,image:e.picture,duration:y.participant_joined_waitlist,button:{text:"Accept",variant:"secondary",onClick:async()=>{await this.meeting.participants.acceptWaitingRoomRequest(e.id),this.remove(t)}}}),b.participant_joined_waitlist&&this.canPlayParticipantJoinedSound()&&this.audio.play("message")},this.chatUpdateListener=({message:t})=>{const i=(0,c.p)(t);if(null!=i){if(i.userId===e.self.userId)return;"text"===i.type&&(u.chat&&this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`${i.displayName}: ${(0,v.s)(i.message,20)}`,duration:y.chat}),b.chat&&this.canPlayChatSound()&&this.audio.play("message"))}},this.pollUpdateListener=({polls:e,newPoll:t})=>{!1!==t&&(u.polls&&this.meeting.self.userId!==e[e.length-1].createdByUserId&&this.add({id:`poll-${Math.random().toString(36)}`,icon:this.iconPack.poll,message:`New poll created by ${e[e.length-1].createdBy}`,duration:y.polls}),b.polls&&this.meeting.self.userId!==e[e.length-1].createdByUserId&&this.canPlayChatSound()&&this.audio.play("message"))},this.deviceUpdateListener=({device:e,preview:t})=>{t||("audiooutput"===e.kind?(this.audio.setDevice(e.deviceId),this.add({id:`speaker-switched-${e.deviceId}`,message:`Connected to ${e.label}`,icon:this.iconPack.speaker,duration:5e3})):"videoinput"===e.kind?this.add({id:`camera-switched-${e.deviceId}`,message:`Connected to ${e.label}`,icon:this.iconPack.speaker,duration:5e3}):this.add({id:`mic-switched-${e.deviceId}`,message:`Connected to ${e.label}`,icon:this.iconPack.mic_on,duration:5e3}))},this.networkDisconnectedListener=()=>{let e;this.remove("network"),e=2e4,this.add({id:"network",icon:this.iconPack.disconnected,message:this.t("network.reconnecting"),duration:2e4}),this.disconnectTimeout=setTimeout((()=>{this.add({id:"network-lost",icon:this.iconPack.disconnected,message:this.t("network.delay"),button:{text:this.t("end"),variant:"danger",onClick:()=>{var e;return null===(e=this.meeting)||void 0===e?void 0:e.leaveRoom()}}})}),2e4)},this.networkConnectedListener=()=>{let e;this.remove("network"),this.remove("network-lost"),e=3e3,this.add({id:"network",icon:this.iconPack.wifi,message:this.t("network.restored"),duration:3e3}),clearTimeout(this.disconnectTimeout)},this.socketUpdateListener=({event:e,attempt:t})=>{this.remove("socket"),"reconnected"===e?(this.remove("socketReconnecting"),this.add({id:"socket",icon:this.iconPack.wifi,message:this.t("network.restored"),duration:3e3})):"disconnected"===e?this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.lost"),duration:3e3}):"reconnecting"===e?this.add({id:"socketReconnecting",icon:this.iconPack.disconnected,message:this.t("network.lost_extended")}):"reconnectFailure"===e?t>5&&(this.remove("socketReconnecting"),this.add({id:"socketReconnecting",icon:this.iconPack.disconnected,message:this.t("network.delay_extended"),button:{text:this.t("end"),variant:"danger",onClick:()=>{var e;return null===(e=this.meeting)||void 0===e?void 0:e.leaveRoom()}}})):"failed"===e&&(this.remove("socketReconnecting"),this.add({id:"socketFailed",icon:this.iconPack.disconnected,message:this.t("network.disconnected")}),this.add({id:"leaveMeeting",icon:this.iconPack.warning,message:this.t("network.leaving")}),setTimeout((()=>{var e;null===(e=this.meeting)||void 0===e||e.leaveRoom("disconnected")}),1e4))},this.spotlightTabUpdateListener=t=>{if(u.tab_sync)switch(t.type){case"plugin":const i=e.plugins.active.toArray().find((e=>e.id==t.id));null!=i&&this.add({id:"spotlight",message:`Plugin switched to ${i.name}`,duration:y.participant_joined});break;case"screenshare":const a=e.participants.joined.toArray().filter((e=>e.screenShareEnabled)).find((e=>e.id==t.id));null!=a&&this.add({id:"spotlight",message:`Now watching ${a.name}'s screen`,duration:y.webinar})}},this.peerRequestToJoinStateListener=({id:e})=>{if(!u.webinar)return;const t=this.meeting.participants.joined.get(e);void 0!==t&&(this.add({id:`webinar-request-${e}`,message:`${t.name} is requesting to be on stage`,duration:y.webinar,button:{text:"Accept",variant:"primary",onClick:async()=>{await this.meeting.participants.acceptAllRequestToJoinStageRequests([{id:e,requestToJoinType:"REQUEST_TO_PRESENT"}]),this.remove(`webinar-request-${e}`)}}}),b.webinar&&this.audio.play("joined"))},this.peerAcceptedToJoinStageListener=e=>{if(!u.webinar)return;const t=this.meeting.participants.joined.get(e.id);void 0!==t&&(this.add({id:`webinar-accepted-${e.id}`,message:`Approved ${t.name}'s request to join stage.`,duration:y.webinar}),b.webinar&&this.audio.play("joined"))},this.peerRejectedToJoinStageListener=e=>{if(!u.webinar)return;const t=this.meeting.participants.joined.get(e.id);void 0!==t&&this.add({id:`webinar-rejected-${e.id}`,message:`Rejected ${t.name}'s request to join stage.`,duration:y.webinar})},this.stageRequestAccepted=()=>{this.add({id:"stage-request-accepted",message:"Request to join accepted",duration:3e3})},this.stageRequestRejected=()=>{this.add({id:"stage-request-rejected",message:"Request to join rejected",duration:3e3})},this.newStageRequests=({count:e})=>{this.add({id:"new-stage-request",message:`You have ${e} pending request${1===e?"":"s"}`,duration:3e3})},this.stageStatusUpdateListener=t=>{"ON_STAGE"===t?this.addStagePeersListeners(e):this.removeStagePeersListeners(e)},this.socketReconnectedListener=()=>this.socketUpdateListener({event:"reconnected"}),this.socketDisconnectedListener=()=>this.socketUpdateListener({event:"disconnected"}),this.socketReconnectingListener=()=>this.socketUpdateListener({event:"reconnecting"}),this.socketFailureListener=()=>this.socketUpdateListener({event:"failed"}),this.socketReconnectFailureListener=({attempt:e})=>this.socketUpdateListener({event:"reconnectFailure",attempt:e}),!(0,s.s)(e)&&(null===(i=e.chat)||void 0===i||i.addListener("chatUpdate",this.chatUpdateListener)),"CHAT"===e.self.config.viewType)return;const f=e.self.getCurrentDevices();null!=f.speaker&&this.audio.setDevice(f.speaker.deviceId),g?null===(a=e.stage)||void 0===a||a.on("stageStatusUpdate",this.stageStatusUpdateListener):this.addStagePeersListeners(e),e.participants.joined.addListener("peerRequestToJoinStage",this.peerRequestToJoinStateListener),e.participants.joined.addListener("peerAcceptedToJoinStage",this.peerAcceptedToJoinStageListener),e.participants.joined.addListener("peerRejectedToJoinStage",this.peerRejectedToJoinStageListener),this.canAcceptWaitingRequests()&&e.participants.waitlisted.addListener("participantJoined",this.waitlistedParticipantJoinedListener),null===(o=e.polls)||void 0===o||o.addListener("pollsUpdate",this.pollUpdateListener),e.self.addListener("deviceUpdate",this.deviceUpdateListener),e.meta.addListener("socketReconnected",this.socketReconnectedListener),e.meta.addListener("socketDisconnected",this.socketDisconnectedListener),e.meta.addListener("socketReconnecting",this.socketReconnectingListener),e.meta.addListener("socketFailure",this.socketFailureListener),e.meta.addListener("socketReconnectFailure",this.socketReconnectFailureListener),null===(r=e.remote)||void 0===r||r.addListener("remoteUpdate",this.onRemoteUpdate),null===(n=e.spotlight)||void 0===n||n.addListener("activeTabUpdate",this.spotlightTabUpdateListener),null===(d=e.recording)||void 0===d||d.addListener("recordingUpdate",this.onRecordingUpdate),null===(l=e.stage)||void 0===l||l.addListener("stageRequestApproved",this.stageRequestAccepted),null===(h=e.stage)||void 0===h||h.addListener("stageRequestRejected",this.stageRequestRejected),e.self.permissions.acceptPresentRequests&&(null===(p=e.stage)||void 0===p||p.addListener("newStageRequest",this.newStageRequests))}configChanged(e){null!=e&&null!=(null==e?void 0:e.config)&&(this.permissions=function(e){const t=Object.assign({},S);return null==e||(Object.assign(t.notification_sounds,e.notification_sounds),Object.assign(t.notifications,e.notifications),Object.assign(t.notification_duration,e.notification_duration),t.participant_chat_message_sound_notification_limit=e.participant_chat_message_sound_notification_limit,t.participant_joined_sound_notification_limit=e.participant_joined_sound_notification_limit),t}(e.config),this.enabledSounds=D(this.permissions.notification_sounds))}statesChanged(e){var t;if(null!=e){const i=!(null===(t=null==e?void 0:e.prefs)||void 0===t?void 0:t.muteNotificationSounds);for(const e of this.enabledSounds)e in this.permissions.notification_sounds&&(this.permissions.notification_sounds[e]=i)}}apiErrorListener({detail:e}){const{trace:t,message:i}=e;this.add({id:t,message:i,duration:L,icon:this.iconPack.warning})}add(e){"visible"===document.visibilityState&&this.notifications.length<5&&(this.notifications=[...this.notifications,e])}remove(e){this.notifications=this.notifications.filter((t=>t.id!==e))}handleDismiss(e){e.stopPropagation();const t=e.detail,i=this.host.shadowRoot.querySelector(`[data-id="${t}"]`);null==i||i.classList.add("exit"),setTimeout((()=>{(0,a.w)((()=>{this.remove(t)}))}),400)}canPlayParticipantJoinedSound(){return null==this.permissions.participant_joined_sound_notification_limit||this.permissions.participant_joined_sound_notification_limit<=0||this.meeting.participants.count<=this.permissions.participant_joined_sound_notification_limit}canPlayChatSound(){return null==this.permissions.participant_chat_message_sound_notification_limit||this.permissions.participant_chat_message_sound_notification_limit<=0||this.meeting.participants.count<=this.permissions.participant_chat_message_sound_notification_limit}canAcceptWaitingRequests(){return this.permissions.notifications.participant_joined_waitlist&&this.meeting.self.permissions.acceptWaitingRequests}render(){return(0,a.h)(a.H,null,this.notifications.map((e=>(0,a.h)("dyte-notification",{size:this.size,key:e.id,"data-id":e.id,notification:e,onDyteNotificationDismiss:e=>this.handleDismiss(e),iconPack:this.iconPack,t:this.t}))))}get host(){return(0,a.g)(this)}static get watchers(){return{meeting:["meetingChanged"],config:["configChanged"],states:["statesChanged"]}}};M.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:absolute;top:var(--dyte-space-4, 16px);right:var(--dyte-space-4, 16px);bottom:var(--dyte-space-4, 16px);left:var(--dyte-space-4, 16px);top:auto;display:flex;flex-direction:column;pointer-events:none;z-index:100}dyte-notification{margin-top:var(--dyte-space-2, 8px)}"},3367:(e,t,i)=>{var a;i.d(t,{R:()=>a}),function(e){e.REQUEST_RECEIVED="REQUEST_RECEIVED",e.REQUEST_SENT="REQUEST_SENT",e.INCOMING_REQUEST_ACCEPTED="INCOMING_REQUEST_ACCEPTED",e.OUTGOING_REQUEST_ACCEPTED="OUTGOING_REQUEST_ACCEPTED",e.INCOMING_REQUEST_ENDED="INCOMING_REQUEST_ENDED",e.OUTGOING_REQUEST_ENDED="OUTGOING_REQUEST_ENDED"}(a||(a={}))},6386:(e,t,i)=>{i.d(t,{l:()=>a});const a=console},1007:(e,t,i)=>{i.d(t,{D:()=>o});var a=i(6386);const s={joined:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_join.mp3",left:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_join.mp3",message:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_message.mp3"};class o{constructor(){this.audio=document.createElement("audio"),this.audio.volume=.3}play(e,t=3e3){var i;this.playing||(this.playing=!0,this.audio.src=s[e],this.audio.volume=.3,null===(i=this.audio.play())||void 0===i||i.catch((i=>{a.l.error("[dyte-notifications] play() failed\n",{sound:e,duration:t},i)})),setTimeout((()=>{this.playing=!1}),t))}async setDevice(e){var t,i,s;await(null===(s=null===(i=null===(t=this.audio)||void 0===t?void 0:t.setSinkId)||void 0===i?void 0:i.call(t,e))||void 0===s?void 0:s.catch((e=>{a.l.error("[dyte-notifications] setSinkId() error\n",e)})))}}}}]);